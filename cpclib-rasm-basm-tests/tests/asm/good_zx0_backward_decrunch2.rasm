	; command line to assemble with rasm:
	;  bndbuild --direct -- rasm tests/asm/good_zx0_backward_decrunch.rasm  -I../cpclib-asm/assets/ -map
	
	fail "add different kind of bytes here to ensure ordering is vamlide. basm imple seems reversed according to discussions with roudoudou"

	BANKSET 0
	
	org 0x100
	run $
	breakpoint

	di

	ld hl, 0xc9fb : ld (0x38), hl
	ld sp, 0xc000

	; uncrunch the 100 bytes in 0xc000
	ld hl, CS_LAST_ADDRESS
	ld de, US_LAST_ADDRESS
	call dzx0_back
	jp $

	; create an area of 100 zero, but compress it
CS_START
	LZX0B
INNER_START
		defs 80, 0xff
		defs 80, 0xff
		; forward : 90 FF 17 55 55 80
		; backward: 3A FF BD AA AA 00  
INNER_STOP
	LZCLOSE
CS_STOP


	; set up the needed symbols to uncruch
CS_LAST_ADDRESS = CS_START + 6- 1 ; as in the doc. but does not work
US_LAST_ADDRESS = 0xc000 + 100- 1 


	; include the embedded uncruncher
	include "uncrunch/dzx0_turbo_back.asm"
dzx0_back
	dzx0_turbo_back (void)

